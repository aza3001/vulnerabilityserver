<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:2155" version="2" class="vulnerability">
         <metadata>
            <title>Windows Server 2003 HtmlHelp Heap Overflow</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2003</platform>
               <product>HTML Help Facility</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2004-0201"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0201"/>
            <description>Heap-based buffer overflow in the HtmlHelp program (hh.exe) in HTML Help for Microsoft Windows 98, Me, NT 4.0, 2000, XP, and Server 2003 allows remote attackers to execute arbitrary commands via a .CHM file with a large length field, a different vulnerability than CVE-2003-1041.</description>
            <oval_repository>
               <dates>
                  <submitted date="2004-07-14T12:00:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
                  </submitted>
                  <status_change date="2004-08-04T12:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-08-25T12:00:00.000-04:00">ACCEPTED</status_change>
                  <modified comment="Corrected obj:964. Changed registry key name from a pattern match of .* to nil."
                            date="2007-02-12T13:46:00.470-05:00">
                     <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
                  </modified>
                  <status_change date="2007-02-12T13:47:37.040-05:00">INTERIM</status_change>
                  <status_change date="2007-03-21T16:17:12.188-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <criteria comment="Software section" operator="AND">
               <criterion comment="Windows Server 2003 is installed" negate="false"
                          test_ref="oval:org.mitre.oval:tst:2761"/>
               <criterion comment="the version of itss.dll is less than 5.2.3790.185" negate="false"
                          test_ref="oval:org.mitre.oval:tst:1406"/>
               <criterion comment="the patch kb840315 is installed" negate="true"
                          test_ref="oval:org.mitre.oval:tst:1405"/>
            </criteria>
            <criteria comment="Configuration section" operator="AND">
               <criterion comment="HTML Help is registered" negate="true"
                          test_ref="oval:org.mitre.oval:tst:1404"/>
            </criteria>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:1406"
                 version="1"
                 comment="the version of itss.dll is less than 5.2.3790.185"
                 check_existence="at_least_one_exists"
                 check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:966"/>
         <state state_ref="oval:org.mitre.oval:ste:1265"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:1405"
                     version="1"
                     comment="the patch kb840315 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:965"/>
         <state state_ref="oval:org.mitre.oval:ste:1264"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:1404"
                     version="2"
                     comment="HTML Help is registered"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:964"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2761"
                     version="1"
                     comment="Windows Server 2003 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2582"/>
      </registry_test>
   </tests>
   <objects>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:966"
                   version="1">
         <path var_ref="oval:org.mitre.oval:var:200" var_check="all"/>
         <filename>itss.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:965"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\KB840315</key>
         <name>Installed</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:964"
                       version="2">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Classes\ITSProtocol</key>
         <name xsi:nil="true"/>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:419"
                       version="1"
                       comment="This registry key holds the version of the installed operating system.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CurrentVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:1265"
                  version="1">
         <version datatype="version" operation="less than">5.2.3790.185</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:1264"
                      version="1">
         <value datatype="binary">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2582"
                      version="1"
                      comment="The registry key has a value of 5.2">
         <value>5.2</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:200" version="1"
                      comment="Windows System32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\System32</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>