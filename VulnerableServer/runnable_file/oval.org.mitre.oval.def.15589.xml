<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:15589" version="3" class="vulnerability">
         <metadata>
            <title>XSS scriptresx.ashx Vulnerability - MS12-050</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Server 2008 R2</platform>
               <product>Microsoft SharePoint Foundation 2010</product>
               <product>Microsoft SharePoint Server 2010</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2012-1859"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1859"/>
            <description>Cross-site scripting (XSS) vulnerability in scriptresx.ashx in Microsoft SharePoint Server 2010 Gold and SP1, SharePoint Foundation 2010 Gold and SP1, and Office Web Apps 2010 Gold and SP1 allows remote attackers to inject arbitrary web script or HTML via crafted JavaScript elements in a URL, aka "XSS scriptresx.ashx Vulnerability."</description>
            <oval_repository>
               <dates>
                  <submitted date="2012-07-16T12:35:55">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </submitted>
                  <status_change date="2012-07-19T12:32:14.134-04:00">DRAFT</status_change>
                  <status_change date="2012-08-06T04:00:12.193-04:00">INTERIM</status_change>
                  <status_change date="2012-08-27T04:00:28.676-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="OR">
            <criteria operator="AND" comment="sharepoint server 2010">
               <criterion comment="Check if the version of Microsoft.office.server.native.dll is less than 14.0.6108.5000"
                          test_ref="oval:org.mitre.oval:tst:79844"/>
               <criteria operator="OR" comment="shrepoint server 2010/sp1">
                  <extend_definition comment="Microsoft Office SharePoint Server 2010 is installed."
                                     definition_ref="oval:org.mitre.oval:def:12880"/>
                  <extend_definition comment="Microsoft SharePoint Server 2010 Service Pack 1 is installed"
                                     definition_ref="oval:org.mitre.oval:def:15614"/>
               </criteria>
            </criteria>
            <criteria operator="AND" comment="sharepoint foundation 2010">
               <criterion comment="Check if the version of Onfda.dll is less than 14.0.6106.5000"
                          test_ref="oval:org.mitre.oval:tst:79803"/>
               <criteria operator="OR" comment="sharepoint foundation 2010/sp1">
                  <extend_definition comment="Microsoft SharePoint Foundation 2010 is installed"
                                     definition_ref="oval:org.mitre.oval:def:12224"/>
                  <extend_definition comment="Microsoft SharePoint Foundation 2010 Service Pack 1 is installed"
                                     definition_ref="oval:org.mitre.oval:def:15661"/>
               </criteria>
            </criteria>
         </criteria>
      </definition>
      <definition id="oval:org.mitre.oval:def:15661" version="3" class="inventory">
         <metadata>
            <title>Microsoft SharePoint Foundation 2010 Service Pack 1 is installed</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Server 2008 R2</platform>
               <platform>Microsoft Windows Vista</platform>
               <platform>Microsoft Windows 7</platform>
               <product>Microsoft SharePoint Foundation 2010</product>
            </affected>
            <reference source="CPE" ref_id="cpe:/a:microsoft:sharepoint_foundation:2010:sp1"/>
            <description>Microsoft SharePoint Foundation 2010 SP1 is installed</description>
            <oval_repository>
               <dates>
                  <submitted date="2012-07-16T12:35:55">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </submitted>
                  <status_change date="2012-07-19T12:32:12.759-04:00">DRAFT</status_change>
                  <status_change date="2012-08-06T04:00:14.532-04:00">INTERIM</status_change>
                  <status_change date="2012-08-27T04:00:33.335-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <extend_definition comment="Microsoft SharePoint Foundation 2010 is installed"
                               definition_ref="oval:org.mitre.oval:def:12224"/>
            <criterion comment="Check if Microsoft SharePoint Foundation 2010 Service Pack 1 is installed"
                       test_ref="oval:org.mitre.oval:tst:79390"/>
         </criteria>
      </definition>
      <definition id="oval:org.mitre.oval:def:15614" version="3" class="inventory">
         <metadata>
            <title>Microsoft SharePoint Server 2010 Service Pack 1 is installed</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Server 2008 R2</platform>
               <platform>Microsoft Windows Vista</platform>
               <platform>Microsoft Windows 7</platform>
               <product>Microsoft SharePoint Server 2010</product>
            </affected>
            <reference source="CPE" ref_id="cpe:/a:microsoft:sharepoint_server:2010:sp1"/>
            <description>Microsoft SharePoint Server 2010 SP1 is installed</description>
            <oval_repository>
               <dates>
                  <submitted date="2012-07-16T12:35:55">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </submitted>
                  <status_change date="2012-07-19T12:32:13.329-04:00">DRAFT</status_change>
                  <status_change date="2012-08-06T04:00:12.930-04:00">INTERIM</status_change>
                  <status_change date="2012-08-27T04:00:29.799-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <extend_definition comment="Microsoft Office SharePoint Server 2010 is installed."
                               definition_ref="oval:org.mitre.oval:def:12880"/>
            <criterion comment="Check if Microsoft SharePoint Server 2010 Service Pack 1 is installed"
                       test_ref="oval:org.mitre.oval:tst:80093"/>
         </criteria>
      </definition>
      <definition id="oval:org.mitre.oval:def:12880" version="3" class="inventory">
         <metadata>
            <title>Microsoft Office SharePoint Server 2010 is installed.</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Server 2008 R2</platform>
               <product>Microsoft Office SharePoint Server 2010</product>
            </affected>
            <reference source="CPE" ref_id="cpe:/a:microsoft:sharepoint:2010"/>
            <description>Microsoft Office SharePoint Server 2010 is installed.</description>
            <oval_repository>
               <dates>
                  <submitted date="2011-09-13T13:00:00">
                     <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
                  </submitted>
                  <status_change date="2011-09-20T09:24:26.061-04:00">DRAFT</status_change>
                  <status_change date="2011-10-10T04:00:35.882-04:00">INTERIM</status_change>
                  <status_change date="2011-10-31T04:01:00.596-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria>
            <criterion comment="SharePoint Server 2010 is installed."
                       test_ref="oval:org.mitre.oval:tst:43555"/>
         </criteria>
      </definition>
      <definition id="oval:org.mitre.oval:def:12224" version="3" class="inventory">
         <metadata>
            <title>Microsoft SharePoint Foundation 2010 is installed</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Server 2008 R2</platform>
               <product>Microsoft SharePoint Foundation 2010</product>
            </affected>
            <reference source="CPE" ref_id="cpe:/a:microsoft:sharepoint_foundation:2010"/>
            <description>Microsoft SharePoint Foundation 2010 is installed.</description>
            <oval_repository>
               <dates>
                  <submitted date="2011-09-13T13:00:00">
                     <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
                  </submitted>
                  <status_change date="2011-09-20T09:24:26.985-04:00">DRAFT</status_change>
                  <status_change date="2011-10-10T04:00:07.602-04:00">INTERIM</status_change>
                  <status_change date="2011-10-31T04:00:15.672-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria>
            <criterion comment="SharePoint Foundation 2010 is installed."
                       test_ref="oval:org.mitre.oval:tst:43939"/>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:79390"
                     version="1"
                     comment="Check if Microsoft SharePoint Foundation 2010 Service Pack 1 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:24020"/>
         <state state_ref="oval:org.mitre.oval:ste:19815"/>
      </registry_test>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:79803"
                 version="1"
                 comment="Check if the version of Onfda.dll is less than 14.0.6106.5000"
                 check_existence="at_least_one_exists"
                 check="all">
         <object object_ref="oval:org.mitre.oval:obj:23783"/>
         <state state_ref="oval:org.mitre.oval:ste:12737"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:80093"
                     version="1"
                     comment="Check if Microsoft SharePoint Server 2010 Service Pack 1 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:24062"/>
         <state state_ref="oval:org.mitre.oval:ste:19908"/>
      </registry_test>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:79844"
                 version="1"
                 comment="Check if the version of Microsoft.office.server.native.dll is less than 14.0.6108.5000"
                 check_existence="at_least_one_exists"
                 check="all">
         <object object_ref="oval:org.mitre.oval:obj:24032"/>
         <state state_ref="oval:org.mitre.oval:ste:19858"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:43555"
                     version="1"
                     comment="SharePoint Server 2010 is installed."
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:16204"/>
         <state state_ref="oval:org.mitre.oval:ste:12994"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:43939"
                     version="1"
                     comment="SharePoint Foundation 2010 is installed."
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:16233"/>
         <state state_ref="oval:org.mitre.oval:ste:12950"/>
      </registry_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:24020"
                       version="1"
                       comment="Object holds if Microsoft SharePoint Foundation 2010 Service Pack 1 is installed">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{90140000-1014-0000-1000-0000000FF1CE}\_Office14\.WSS_{[\w\-]+}$</key>
         <name>DisplayName</name>
      </registry_object>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:23783"
                   version="1"
                   comment="Object holds the path to Onfda.dll">
         <path var_ref="oval:org.mitre.oval:var:1390" var_check="all"/>
         <filename>Onfda.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:24062"
                       version="1"
                       comment="Object holds if Microsoft SharePoint Server 2010 Service Pack 1 is installed">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{90140000-1014-0000-1000-0000000FF1CE}\_Office14\.OSERVER_{[\w\-]+}$</key>
         <name>DisplayName</name>
      </registry_object>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:24032"
                   version="1"
                   comment="Object holds the path to Microsoft.office.server.native.dll">
         <path var_ref="oval:org.mitre.oval:var:1138" var_check="all"/>
         <filename>Microsoft.office.server.native.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:23943"
                       version="1"
                       comment="The registry holds the install location of sharepoint server 2010">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Office14.OSERVER</key>
         <name>InstallLocation</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:16204"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{90140000-110D-0000-1000-0000000FF1CE}</key>
         <name>DisplayName</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:16233"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{90140000-1110-0000-1000-0000000FF1CE}</key>
         <name>DisplayName</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:281"
                       version="1"
                       comment="The registry key that identifies the location of the common files directory.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows\CurrentVersion</key>
         <name>CommonFilesDir</name>
      </registry_object>
   </objects>
   <states>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:19815"
                      version="1"
                      comment="State holds if Microsoft SharePoint Foundation 2010 Service Pack 1 is installed">
         <value>Microsoft SharePoint Foundation 2010 Service Pack 1 (SP1)</value>
      </registry_state>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:12737"
                  version="1">
         <version datatype="version" operation="less than">14.0.6106.5000</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:19908"
                      version="1"
                      comment="State holds the value for Microsoft SharePoint Server 2010 Service Pack 1">
         <value>Microsoft SharePoint 2010 Service Pack 1 (SP1)</value>
      </registry_state>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:19858"
                  version="1"
                  comment="State matches if the version is less than 14.0.6108.5000">
         <version datatype="version" operation="less than">14.0.6108.5000</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:12994"
                      version="1"
                      comment="The registry key has a value of Microsoft SharePoint Server 2010">
         <value>Microsoft SharePoint Server 2010</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:12950"
                      version="1"
                      comment="The registry key has a value of Microsoft SharePoint Foundation 2010">
         <value>Microsoft SharePoint Foundation 2010</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:1390" version="1"
                      comment="Full file path to Onfda.dll"
                      datatype="string">
         <concat>
            <object_component object_ref="oval:org.mitre.oval:obj:281" item_field="value"/>
            <literal_component>\Microsoft Shared\web server extensions\14\BIN\</literal_component>
         </concat>
      </local_variable>
      <local_variable id="oval:org.mitre.oval:var:1138" version="1"
                      comment="Full file path to Microsoft.office.server.native.dll"
                      datatype="string">
         <concat>
            <object_component object_ref="oval:org.mitre.oval:obj:23943" item_field="value"/>
            <literal_component>\14.0\bin</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>