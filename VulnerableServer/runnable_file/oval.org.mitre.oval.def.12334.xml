<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:12334" version="3" class="vulnerability">
         <metadata>
            <title>Vulnerability in the Standard PHP Library (SPL) extension in PHP before 5.3.4</title>
            <affected family="windows">
               <platform>Microsoft Windows 2000</platform>
               <platform>Microsoft Windows 7</platform>
               <platform>Microsoft Windows Server 2003</platform>
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Vista</platform>
               <platform>Microsoft Windows XP</platform>
               <product>PHP</product>
            </affected>
            <reference ref_id="CVE-2011-0754"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0754"
                       source="CVE"/>
            <description>The SplFileInfo::getType function in the Standard PHP Library (SPL) extension in PHP before 5.3.4 on Windows does not properly detect symbolic links, which might make it easier for local users to conduct symlink attacks by leveraging cross-platform differences in the stat structure, related to lack of a FILE_ATTRIBUTE_REPARSE_POINT check.</description>
            <oval_repository>
               <dates>
                  <submitted date="2011-03-29T09:34:15-05:00">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </submitted>
                  <status_change date="2011-03-29T14:26:01.373-04:00">DRAFT</status_change>
                  <status_change date="2011-04-18T04:00:16.652-04:00">INTERIM</status_change>
                  <status_change date="2011-05-09T04:00:33.804-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <extend_definition comment="PHP is installed" definition_ref="oval:org.mitre.oval:def:12410"/>
            <criterion comment="Check if the version of PHP is less than 5.3.4"
                       test_ref="oval:org.mitre.oval:tst:41865"/>
         </criteria>
      </definition>
      <definition id="oval:org.mitre.oval:def:12410" version="4" class="inventory">
         <metadata>
            <title>PHP is installed</title>
            <affected family="windows">
               <platform>Microsoft Windows 2000</platform>
               <platform>Microsoft Windows 7</platform>
               <platform>Microsoft Windows Server 2003</platform>
               <platform>Microsoft Windows Server 2008</platform>
               <platform>Microsoft Windows Vista</platform>
               <platform>Microsoft Windows XP</platform>
               <product>PHP</product>
            </affected>
            <reference ref_id="cpe:/a:php:php" source="CPE"/>
            <description>PHP is installed</description>
            <oval_repository>
               <dates>
                  <submitted date="2010-12-23T15:27:18">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </submitted>
                  <status_change date="2010-12-27T20:21:09.434-05:00">DRAFT</status_change>
                  <status_change date="2011-01-17T04:00:16.671-05:00">INTERIM</status_change>
                  <modified comment="Added a registry test to support for lower versions of PHP"
                            date="2011-02-08T16:21:49.575+05:30">
                     <contributor organization="SecPod Technologies">SecPod Team</contributor>
                  </modified>
                  <status_change date="2011-04-04T04:00:17.011-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="OR">
            <criterion comment="Check if PHP is installed" test_ref="oval:org.mitre.oval:tst:41246"/>
            <criterion comment="Check if PHP lower versions are installed"
                       test_ref="oval:org.mitre.oval:tst:42177"/>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:41865"
                     version="1"
                     comment="Check if the version of PHP is less than 5.3.4"
                     check_existence="at_least_one_exists"
                     check="all">
         <object object_ref="oval:org.mitre.oval:obj:15645"/>
         <state state_ref="oval:org.mitre.oval:ste:12022"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:42177"
                     version="1"
                     comment="Check if PHP lower versions are installed"
                     check_existence="at_least_one_exists"
                     check="all">
         <object object_ref="oval:org.mitre.oval:obj:15805"/>
         <state state_ref="oval:org.mitre.oval:ste:12451"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:41246"
                     version="1"
                     comment="Check if PHP is installed"
                     check_existence="at_least_one_exists"
                     check="all">
         <object object_ref="oval:org.mitre.oval:obj:15719"/>
      </registry_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:15645"
                       version="1"
                       comment="The registry holds the version of PHP installed">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\PHP</key>
         <name>Version</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:15805"
                       version="1"
                       comment="The registry holds if lower versions of PHP is installed">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\PHP.*$</key>
         <name>DisplayName</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:15719"
                       version="1"
                       comment="The registry holds if PHP is installed">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\PHP</key>
         <name xsi:nil="true"/>
      </registry_object>
   </objects>
   <states>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:12022"
                      version="1"
                      comment="State matches if the version is less than 5.3.4">
         <value datatype="version" operation="less than">5.3.4</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:12451"
                      version="1"
                      comment="State matches if lower versions of PHP is installed">
         <value operation="pattern match">^PHP.*$</value>
      </registry_state>
   </states>
</oval_definitions>