<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:7496" version="2" class="vulnerability">
         <metadata>
            <title>IE v6.0,SP2 for Server 2003 Similar Method Name Redirection Cross Domain Vulnerability</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2003</platform>
               <product>Microsoft Internet Explorer</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2004-0727"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0727"/>
            <description>Microsoft Internet Explorer 6.0.2800.1106 on Microsoft Windows XP SP2, and other versions including 5.01 and 5.5, allows remote web servers to bypass zone restrictions and execute arbitrary code in the local computer zone by redirecting a function to another function with the same name, as demonstrated by SimilarMethodNameRedir, aka the "Similar Method Name Redirection Cross Domain Vulnerability."</description>
            <oval_repository>
               <dates>
                  <submitted date="2004-10-19T07:40:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Harvey Rubinovitz</contributor>
                  </submitted>
                  <status_change date="2004-10-20T02:41:00.000-04:00">DRAFT</status_change>
                  <status_change date="2004-11-03T12:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-12-09T08:46:00.000-04:00">ACCEPTED</status_change>
                  <modified comment="Corrected ste:267. Set version element datatype to version. Implemented by Jon Baker of The MITRE Corporation."
                            date="2007-01-13T20:19:00.959-05:00">
                     <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
                  </modified>
                  <status_change date="2007-01-13T20:19:46.066-05:00">INTERIM</status_change>
                  <modified comment="Fixed obj:246: Removed HKEY_LOCAL_MACHINE\ from the key, as it's specified as the hive.  Implemented by Harvey Rubinovitz."
                            date="2007-01-22T00:36:00.713-05:00">
                     <contributor organization="Centennial Software">John Hoyland</contributor>
                  </modified>
                  <status_change date="2007-02-20T13:40:55.564-05:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <criteria comment="Software section" operator="AND">
               <criterion comment="Internet Explorer 6 Service Pack 2 for XP is installed" negate="false"
                          test_ref="oval:org.mitre.oval:tst:269"/>
               <criteria operator="OR" comment="a vulnerable version of mshtml.dll exisits">
                  <criterion comment="machine has followed the GDR update path and mshtml.dll is less than  6.0.2900.2523"
                             negate="false"
                             test_ref="oval:org.mitre.oval:tst:268"/>
                  <criterion comment="machine has followed the QFE update path and mshtml.dll is less than  6.0.2900.2524"
                             negate="false"
                             test_ref="oval:org.mitre.oval:tst:267"/>
               </criteria>
               <criterion comment="the patch kb834707  is installed (Installed Components key)"
                          negate="true"
                          test_ref="oval:org.mitre.oval:tst:266"/>
            </criteria>
            <criteria comment="Configuration section" operator="AND">
               <criteria operator="OR" comment="ActiveX controls and active scripting are enabled">
                  <criteria operator="AND"
                            comment="current user settings are being used and ActiveX controls and active scripting are enabled">
                     <criterion comment="use machine settings rather than individual user settings"
                                negate="true"
                                test_ref="oval:org.mitre.oval:tst:2951"/>
                     <criterion comment="ActiveX controls are enabled for the current user" negate="false"
                                test_ref="oval:org.mitre.oval:tst:2917"/>
                     <criterion comment="active scripting is enabled for the current user" negate="false"
                                test_ref="oval:org.mitre.oval:tst:2812"/>
                  </criteria>
                  <criteria operator="AND"
                            comment="local machine settings are being used and ActiveX controls and active scripting are enabled">
                     <criterion comment="use machine settings rather than individual user settings"
                                negate="false"
                                test_ref="oval:org.mitre.oval:tst:2951"/>
                     <criterion comment="ActiveX controls are enabled for the local machine" negate="false"
                                test_ref="oval:org.mitre.oval:tst:2916"/>
                     <criterion comment="active scripting is enabled for the local machine" negate="false"
                                test_ref="oval:org.mitre.oval:tst:2811"/>
                  </criteria>
               </criteria>
            </criteria>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:269"
                     version="2"
                     check="at least one"
                     comment="Internet Explorer 6 Service Pack 2 for XP is installed"
                     check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:247"/>
         <state state_ref="oval:org.mitre.oval:ste:267"/>
      </registry_test>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:268"
                 version="1"
                 check="at least one"
                 comment="machine has followed the GDR update path and mshtml.dll is less than  6.0.2900.2523"
                 check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:222"/>
         <state state_ref="oval:org.mitre.oval:ste:266"/>
      </file_test>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:267"
                 version="1"
                 check="at least one"
                 comment="machine has followed the QFE update path and mshtml.dll is less than  6.0.2900.2524"
                 check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:222"/>
         <state state_ref="oval:org.mitre.oval:ste:265"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:266"
                     version="2"
                     check="at least one"
                     comment="the patch kb834707  is installed (Installed Components key)"
                     check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:246"/>
         <state state_ref="oval:org.mitre.oval:ste:264"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2951"
                     version="1"
                     comment="use machine settings rather than individual user settings"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:990"/>
         <state state_ref="oval:org.mitre.oval:ste:2766"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2917"
                     version="1"
                     comment="ActiveX controls are enabled for the current user"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1671"/>
         <state state_ref="oval:org.mitre.oval:ste:2733"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2916"
                     version="1"
                     comment="ActiveX controls are enabled for the local machine"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:988"/>
         <state state_ref="oval:org.mitre.oval:ste:2732"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2812"
                     version="1"
                     comment="active scripting is enabled for the current user"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1609"/>
         <state state_ref="oval:org.mitre.oval:ste:2632"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2811"
                     version="1"
                     comment="active scripting is enabled for the local machine"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1608"/>
         <state state_ref="oval:org.mitre.oval:ste:2631"/>
      </registry_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:246"
                       version="2">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="equals">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\KB834707</key>
         <name operation="equals">IsInstalled</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:990"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings</key>
         <name>Security_HKLM_only</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:247"
                       version="1"
                       comment="This registry key identifies the version of Internet Explorer">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Internet Explorer</key>
         <name>Version</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1671"
                       version="1">
         <hive>HKEY_CURRENT_USER</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\[0-4]$</key>
         <name>1200</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:988"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\[0-4]$</key>
         <name>1200</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1609"
                       version="1">
         <hive>HKEY_CURRENT_USER</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\[0-4]$</key>
         <name>1400</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1608"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="pattern match">^SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\[0-4]$</key>
         <name>1400</name>
      </registry_object>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:222"
                   version="1"
                   comment="The path to the mshtml.dll file in the system root">
         <path var_ref="oval:org.mitre.oval:var:200" var_check="all"/>
         <filename>mshtml.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:267"
                      version="2">
         <value datatype="version">6.00.2900.2180</value>
      </registry_state>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:266"
                  version="1">
         <version datatype="version" operation="less than">6.0.2900.2523</version>
      </file_state>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:265"
                  version="1">
         <version datatype="version" operation="less than">6.0.2900.2524</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:264"
                      version="1">
         <value datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2766"
                      version="1">
         <value datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2733"
                      version="1">
         <value operation="not equal" datatype="int">3</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2732"
                      version="1">
         <value operation="not equal" datatype="int">3</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2632"
                      version="1">
         <value operation="not equal" datatype="int">3</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2631"
                      version="1">
         <value operation="not equal" datatype="int">3</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:200" version="1"
                      comment="Windows System32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\System32</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>