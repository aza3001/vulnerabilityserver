<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:938" version="1" class="vulnerability">
         <metadata>
            <title>IIS5.0 Windows Media Services Large POST Vulnerability</title>
            <affected family="windows">
               <platform>Microsoft Windows 2000</platform>
               <product>Microsoft Internet Information Server (IIS)</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2003-0349"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0349"/>
            <description>Buffer overflow in the streaming media component for logging multicast requests in the ISAPI for the logging capability of Microsoft Windows Media Services (nsiislog.dll), as installed in IIS 5.0, allows remote attackers to execute arbitrary code via a large POST request to nsiislog.dll.</description>
            <oval_repository>
               <dates>
                  <submitted date="2004-05-18T12:00:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
                  </submitted>
                  <status_change date="2004-06-16T12:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-06-30T12:00:00.000-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria comment="Software section" operator="AND">
            <criterion comment="IIS major version equals 5" negate="false"
                       test_ref="oval:org.mitre.oval:tst:3081"/>
            <criterion comment="IIS minor version equals 0" negate="false"
                       test_ref="oval:org.mitre.oval:tst:3098"/>
            <criterion comment="File %windir%\System32\nsiislog.dll is less than 4.1.0.3932"
                       negate="false"
                       test_ref="oval:org.mitre.oval:tst:1437"/>
            <criterion comment="Patch KB822343 Installed" negate="true"
                       test_ref="oval:org.mitre.oval:tst:1438"/>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:1437"
                 version="1"
                 check="at least one"
                 comment="File %windir%\System32\nsiislog.dll is less than 4.1.0.3932"
                 check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:960"/>
         <state state_ref="oval:org.mitre.oval:ste:1296"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:1438"
                     version="1"
                     check="at least one"
                     comment="Patch KB822343 Installed"
                     check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:981"/>
         <state state_ref="oval:org.mitre.oval:ste:1297"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3098"
                     version="1"
                     comment="IIS minor version equals 0"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:938"/>
         <state state_ref="oval:org.mitre.oval:ste:2903"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3081"
                     version="1"
                     comment="IIS major version equals 5"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1754"/>
         <state state_ref="oval:org.mitre.oval:ste:2886"/>
      </registry_test>
   </tests>
   <objects>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:960"
                   version="1">
         <path var_ref="oval:org.mitre.oval:var:200" var_check="all"/>
         <filename>nsiislog.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:981"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="equals">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\KB822343</key>
         <name operation="equals">Installed</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1754"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\INetStp</key>
         <name>MajorVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:938"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\INetStp</key>
         <name>MinorVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:1296"
                  version="1">
         <version datatype="version" operation="less than">4.1.0.3932</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:1297"
                      version="1">
         <value operation="equals" datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2903"
                      version="1">
         <value datatype="int">0</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2886"
                      version="1">
         <value datatype="int">5</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:200" version="1"
                      comment="Windows System32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\System32</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>