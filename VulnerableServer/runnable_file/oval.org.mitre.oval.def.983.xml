<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:983" version="2" class="vulnerability">
         <metadata>
            <title>Windows XP IIS Out of Process Privilege Elevation Vulnerability</title>
            <affected family="windows">
               <platform>Microsoft Windows XP</platform>
               <product>Microsoft Internet Information Server (IIS)</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2002-0869"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0869"/>
            <description>Unknown vulnerability in the hosting process (dllhost.exe) for Microsoft Internet Information Server (IIS) 4.0 through 5.1 allows remote attackers to gain privileges by executing an out of process application that acquires LocalSystem privileges, aka "Out of Process Privilege Elevation."</description>
            <oval_repository>
               <dates>
                  <submitted date="2004-05-19T12:00:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
                  </submitted>
                  <status_change date="2004-06-16T12:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-06-30T12:00:00.000-04:00">ACCEPTED</status_change>
                  <modified comment="Changed tst:1356 to use obj:496 was introduced to properly look for w3svc.dll in System32/inetsrv."
                            date="2007-07-18T12:59:00.316-04:00">
                     <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
                  </modified>
                  <status_change date="2007-07-18T13:02:43.455-04:00">INTERIM</status_change>
                  <status_change date="2007-08-02T14:47:16.863-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria comment="Software section" operator="AND">
            <criterion comment="IIS major version equals 5" negate="false"
                       test_ref="oval:org.mitre.oval:tst:3081"/>
            <criterion comment="IIS 5.1 Minor Version" negate="false"
                       test_ref="oval:org.mitre.oval:tst:1357"/>
            <criterion comment="File %windir%\System32\w3svc.dll is less than 5.1.2600.1125"
                       negate="false"
                       test_ref="oval:org.mitre.oval:tst:1356"/>
            <criterion comment="Patch Q327696 Installed" negate="true"
                       test_ref="oval:org.mitre.oval:tst:3094"/>
            <criterion comment="Patch Q811114 Installed" negate="true"
                       test_ref="oval:org.mitre.oval:tst:3093"/>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3094"
                     version="1"
                     comment="Patch Q327696 Installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1759"/>
         <state state_ref="oval:org.mitre.oval:ste:2899"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3093"
                     version="1"
                     comment="Patch Q811114 Installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1758"/>
         <state state_ref="oval:org.mitre.oval:ste:2898"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3081"
                     version="1"
                     comment="IIS major version equals 5"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1754"/>
         <state state_ref="oval:org.mitre.oval:ste:2886"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:1357"
                     version="1"
                     comment="IIS 5.1 Minor Version"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:938"/>
         <state state_ref="oval:org.mitre.oval:ste:1219"/>
      </registry_test>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:1356"
                 version="2"
                 check="at least one"
                 comment="File %windir%\System32\w3svc.dll is less than 5.1.2600.1125"
                 check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:496"/>
         <state state_ref="oval:org.mitre.oval:ste:1218"/>
      </file_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1759"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q327696</key>
         <name>Installed</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1758"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q811114</key>
         <name>Installed</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1754"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\INetStp</key>
         <name>MajorVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:938"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\INetStp</key>
         <name>MinorVersion</name>
      </registry_object>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:496"
                   version="1">
         <path var_ref="oval:org.mitre.oval:var:203" var_check="all"/>
         <filename>w3svc.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2899"
                      version="1">
         <value datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2898"
                      version="1">
         <value datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2886"
                      version="1">
         <value datatype="int">5</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:1219"
                      version="1">
         <value datatype="int">1</value>
      </registry_state>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:1218"
                  version="1">
         <version datatype="version" operation="less than">5.1.2600.1125</version>
      </file_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:203" version="1"
                      comment="inetsrv directory in the Windows system 32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\system32\inetsrv</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>