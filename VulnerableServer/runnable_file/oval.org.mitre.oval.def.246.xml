<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:246" version="2" class="vulnerability">
         <metadata>
            <title>Network News Transfer Protocol Buffer Overflow</title>
            <affected family="windows">
               <platform>Microsoft Windows Server 2003</platform>
               <product>Network News Transport Protocol (NNTP)</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2004-0574"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0574"/>
            <description>The Network News Transfer Protocol (NNTP) component of Microsoft Windows NT Server 4.0, Windows 2000 Server, Windows Server 2003, Exchange 2000 Server, and Exchange Server 2003 allows remote attackers to execute arbitrary code via XPAT patterns, possibly related to improper length validation and an "unchecked buffer," leading to off-by-one and heap-based buffer overflows.</description>
            <oval_repository>
               <dates>
                  <submitted date="2004-10-26T09:17:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
                  </submitted>
                  <status_change date="2004-10-27T01:04:00.000-04:00">DRAFT</status_change>
                  <status_change date="2004-11-17T10:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-12-09T08:46:00.000-04:00">ACCEPTED</status_change>
                  <modified comment="set datatype to int" date="2007-10-25T16:45:00.093-04:00">
                     <contributor organization="Opsware, Inc.">Jeff Cheng</contributor>
                  </modified>
                  <status_change date="2007-10-25T16:53:57.636-04:00">INTERIM</status_change>
                  <modified comment="set datatype to int" date="2007-10-25T16:45:00.233-04:00">
                     <contributor organization="Opsware, Inc.">Jeff Cheng</contributor>
                  </modified>
                  <status_change date="2007-11-13T12:01:09.183-05:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <criteria comment="Software section" operator="AND">
               <criteria operator="AND"
                         comment="Exchange Server 2003 is installed on Windows Server 2003">
                  <criterion comment="Windows Server 2003 is installed" negate="false"
                             test_ref="oval:org.mitre.oval:tst:2761"/>
                  <criterion comment="Exchange Server 2003 (gold edition) is installed" negate="false"
                             test_ref="oval:org.mitre.oval:tst:2760"/>
               </criteria>
               <criterion comment="the version of nntpsvc.dll is less than 6.0.3790.206" negate="false"
                          test_ref="oval:org.mitre.oval:tst:2759"/>
               <criterion comment="the patch WindowsServer2003-KB883935-ia64-enu.exe is installed"
                          negate="false"
                          test_ref="oval:org.mitre.oval:tst:2758"/>
            </criteria>
            <criteria comment="Configuration section" operator="AND">
               <criterion comment="the NNTP service is enabled" negate="false"
                          test_ref="oval:org.mitre.oval:tst:2757"/>
            </criteria>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:2759"
                 version="1"
                 check="at least one"
                 comment="the version of nntpsvc.dll is less than 6.0.3790.206"
                 check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:252"/>
         <state state_ref="oval:org.mitre.oval:ste:2580"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2758"
                     version="2"
                     check="at least one"
                     comment="the patch WindowsServer2003-KB883935-ia64-enu.exe is installed"
                     check_existence="at_least_one_exists">
         <object object_ref="oval:org.mitre.oval:obj:297"/>
         <state state_ref="oval:org.mitre.oval:ste:2579"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2757"
                     version="1"
                     comment="the NNTP service is enabled"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1583"/>
         <state state_ref="oval:org.mitre.oval:ste:2578"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2760"
                     version="2"
                     comment="Exchange Server 2003 (gold edition) is installed"
                     check_existence="at_least_one_exists"
                     check="all">
         <object object_ref="oval:org.mitre.oval:obj:1584"/>
         <state state_ref="oval:org.mitre.oval:ste:2581"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2761"
                     version="1"
                     comment="Windows Server 2003 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2582"/>
      </registry_test>
   </tests>
   <objects>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:252"
                   version="1">
         <path var_ref="oval:org.mitre.oval:var:203" var_check="all"/>
         <filename>nntpsvc.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:297"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key operation="equals">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\KB883935</key>
         <name operation="equals">Installed</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1583"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SYSTEM\CurrentControlSet\Services\NntpSvc</key>
         <name>Start</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1584"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Exchange\Setup</key>
         <name>Services Version</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:419"
                       version="1"
                       comment="This registry key holds the version of the installed operating system.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CurrentVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:2580"
                  version="1">
         <version datatype="version" operation="less than">6.0.3790.206</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2579"
                      version="2">
         <value datatype="int">1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2578"
                      version="1">
         <value operation="not equal" datatype="int">4</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2581"
                      version="2">
         <value datatype="int">65</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2582"
                      version="1"
                      comment="The registry key has a value of 5.2">
         <value>5.2</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:203" version="1"
                      comment="inetsrv directory in the Windows system 32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\system32\inetsrv</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>