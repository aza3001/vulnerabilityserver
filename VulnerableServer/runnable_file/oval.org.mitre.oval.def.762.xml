<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:762" version="4" class="vulnerability">
         <metadata>
            <title>MS FrontPage Server Extensions SmartHTML Denial of Service (Test 5)</title>
            <affected family="windows">
               <platform>Microsoft Windows 2000</platform>
               <platform>Microsoft Windows XP</platform>
               <platform>Microsoft Windows Server 2003</platform>
               <product>Microsoft SharePoint Team Services</product>
            </affected>
            <reference source="CVE" ref_id="CVE-2003-0824"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0824"/>
            <description>Unknown vulnerability in the SmartHTML interpreter (shtml.dll) in Microsoft FrontPage Server Extensions 2000 and 2002, and Microsoft SharePoint Team Services 2002, allows remote attackers to cause a denial of service (response failure) via a certain request.</description>
            <oval_repository>
               <dates>
                  <submitted date="2003-12-09T12:00:00.000-04:00">
                     <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
                  </submitted>
                  <modified date="2004-01-14T12:00:00.000-04:00"
                            comment="Changed the definition to look at the file shtml.dll instead of fp5awel.dll.  It was determined that this is where the vulnerability (a buffer overflow) actually existed.  Also added the configuration test saying you are vulnerable if the SmartHTML interpreter is enabled.">
                     <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
                  </modified>
                  <status_change date="2004-03-09T12:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2004-03-25T12:00:00.000-04:00">ACCEPTED</status_change>
                  <modified date="2004-09-14T09:53:00.000-04:00" comment="XP SP2 added">
                     <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
                  </modified>
                  <status_change date="2004-09-15T12:00:00.000-04:00">INTERIM</status_change>
                  <modified comment="Corrected to use a forward slash as the separator in the key."
                            date="2007-05-07T15:59:00.964-04:00">
                     <contributor organization="Secure Elements, Inc.">Glenn Strickland</contributor>
                  </modified>
                  <modified comment="Multiple corrections and update to POSIX compatibility for ste:2656"
                            date="2010-11-29T16:12:00.873-05:00">
                     <contributor organization="G2, Inc.">Shane Shaffer</contributor>
                  </modified>
                  <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services"
                            date="2011-04-25T14:34:00.432-04:00">
                     <contributor organization="Telos">Sudhir Gandhe</contributor>
                  </modified>
                  <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)"
                            date="2011-04-26T11:53:00.464-04:00">
                     <contributor organization="G2, Inc.">Shane Shaffer</contributor>
                  </modified>
               </dates>
               <status>INTERIM</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <criteria operator="AND" comment="Software section">
               <criteria operator="OR" comment="Windows 2000, XP, or 2003 is installed">
                  <criterion comment="Windows 2000 is installed" test_ref="oval:org.mitre.oval:tst:3085"/>
                  <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
                  <criterion comment="Windows Server 2003 is installed"
                             test_ref="oval:org.mitre.oval:tst:2761"/>
               </criteria>
               <criterion comment="a vulnerable version of shtml.dll exists (FPSE 2002 or SPTS 2003)"
                          test_ref="oval:org.mitre.oval:tst:2490"/>
               <criterion negate="true" comment="Win2K/XP/2003 service pack 2 (or later) is installed"
                          test_ref="oval:org.mitre.oval:tst:2837"/>
            </criteria>
            <criteria operator="AND" comment="Configuration section">
               <criterion comment="SharePoint Team Services are enabled (2K, XP, 2003)"
                          test_ref="oval:org.mitre.oval:tst:2379"/>
               <criterion comment="SmartHTML interpreter is enabled"
                          test_ref="oval:org.mitre.oval:tst:2705"/>
            </criteria>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <unknown_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent"
                    id="oval:org.mitre.oval:tst:2490"
                    version="1"
                    comment="a vulnerable version of shtml.dll exists (FPSE 2002 or SPTS 2003)"
                    check_existence="at_least_one_exists"
                    check="all"/>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2379"
                     version="1"
                     comment="SharePoint Team Services are enabled (2K, XP, 2003)"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1361"/>
         <state state_ref="oval:org.mitre.oval:ste:2228"/>
      </registry_test>
      <metabase_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2705"
                     version="2"
                     comment="SmartHTML interpreter is enabled"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1552"/>
      </metabase_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2837"
                     version="4"
                     comment="Win2K/XP/2003 service pack 2 (or later) is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:717"/>
         <state state_ref="oval:org.mitre.oval:ste:2656"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2838"
                     version="1"
                     comment="Windows XP is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2657"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2761"
                     version="1"
                     comment="Windows Server 2003 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2582"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:3085"
                     version="1"
                     comment="Windows 2000 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2890"/>
      </registry_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1361"
                       version="1">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\Setup Packages</key>
         <name>SharePoint</name>
      </registry_object>
      <metabase_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1552"
                       version="2">
         <key>LM/W3SVC</key>
         <id datatype="int">6014</id>
      </metabase_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:419"
                       version="1"
                       comment="This registry key holds the version of the installed operating system.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CurrentVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:717"
                       version="3"
                       comment="This registry key holds the service pack installed on the host if one is present.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CSDVersion</name>
      </registry_object>
   </objects>
   <states>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2228"
                      version="1">
         <value>Installed</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2656"
                      version="2"
                      comment="Regex that matches Service Pack 2 or later">
         <value operation="pattern match">^[Ss][Ee][Rr][Vv][Ii][Cc][Ee] [Pp][Aa][Cc][Kk] ([2-9]|([1-9][0-9]+))$</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2657"
                      version="1"
                      comment="Registry key has a value of 5.1">
         <value>5.1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2582"
                      version="1"
                      comment="The registry key has a value of 5.2">
         <value>5.2</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2890"
                      version="1"
                      comment="Registry key has a value of 5.0">
         <value>5.0</value>
      </registry_state>
   </states>
</oval_definitions>