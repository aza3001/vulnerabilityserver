<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#solaris solaris-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#ios ios-definitions-schema.xsd">
   <generator>
      <oval:product_name>The OVAL Repository</oval:product_name>
      <oval:schema_version>5.3</oval:schema_version>
      <oval:timestamp>2012-09-13T13:01:28.122-04:00</oval:timestamp>
  </generator>
   <definitions>
      <definition id="oval:org.mitre.oval:def:1263" version="6" class="vulnerability">
         <metadata>
            <title>WMF Rendering Code Execution Vulnerability (64-bit Windows XP and Server 2003,Unpatched)</title>
            <affected family="windows">
               <platform>Microsoft Windows XP</platform>
               <platform>Microsoft Windows Server 2003</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-2005-2123"
                       ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2123"/>
            <description>Multiple integer overflows in the Graphics Rendering Engine (GDI32.DLL) in Windows 2000 SP4, XP SP1 and SP2, and Server 2003 SP1 allow remote attackers to execute arbitrary code via crafted Windows Metafile (WMF) and Enhanced Metafile (EMF) format images that lead to heap-based buffer overflows, as demonstrated using MRBP16::bCheckRecord.</description>
            <oval_repository>
               <dates>
                  <submitted date="2005-11-09T12:00:00.000-04:00">
                     <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
                  </submitted>
                  <status_change date="2005-11-10T07:06:00.000-04:00">DRAFT</status_change>
                  <status_change date="2005-12-01T06:00:00.000-04:00">INTERIM</status_change>
                  <status_change date="2005-12-16T01:04:00.000-04:00">ACCEPTED</status_change>
                  <modified comment="Removed unneeded ste:2282 from tst:2437. Deprecated ste:2282 since it is no longer used."
                            date="2007-01-12T07:06:00.595-05:00">
                     <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
                  </modified>
                  <status_change date="2007-01-12T07:08:58.200-05:00">INTERIM</status_change>
                  <status_change date="2007-02-20T13:39:37.874-05:00">ACCEPTED</status_change>
                  <modified comment="EDITED oval:org.mitre.oval:def:1263 - Various corrections to comments and products to align with Authoring Style Guide"
                            date="2011-04-22T23:54:00.899-04:00">
                     <contributor organization="G2, Inc.">Shane Shaffer</contributor>
                  </modified>
                  <status_change date="2011-04-23T00:05:56.154-04:00">INTERIM</status_change>
                  <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services"
                            date="2011-04-25T14:34:00.432-04:00">
                     <contributor organization="Telos">Sudhir Gandhe</contributor>
                  </modified>
                  <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)"
                            date="2011-04-26T11:53:00.464-04:00">
                     <contributor organization="G2, Inc.">Shane Shaffer</contributor>
                  </modified>
                  <status_change date="2011-05-16T04:00:43.924-04:00">ACCEPTED</status_change>
               </dates>
               <status>ACCEPTED</status>
            </oval_repository>
         </metadata>
         <criteria operator="AND">
            <criteria operator="OR" comment="64-bit XP or Server 2003 is installed">
               <criteria operator="AND" comment="64-bit XP is installed">
                  <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
                  <criterion comment="64-Bit (x64 architecture) version of Windows is installed"
                             test_ref="oval:org.mitre.oval:tst:2744"/>
               </criteria>
               <criterion comment="Windows Server 2003 is installed"
                          test_ref="oval:org.mitre.oval:tst:2761"/>
            </criteria>
            <criterion negate="true" comment="Win2K/XP/2003 is patched"
                       test_ref="oval:org.mitre.oval:tst:2437"/>
            <criterion comment="the version of Gdi32.dll is less than 5.2.3790.419"
                       test_ref="oval:org.mitre.oval:tst:2436"/>
         </criteria>
      </definition>
   </definitions>
   <tests>
      <file_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                 id="oval:org.mitre.oval:tst:2436"
                 version="1"
                 comment="the version of Gdi32.dll is less than 5.2.3790.419"
                 check_existence="at_least_one_exists"
                 check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:622"/>
         <state state_ref="oval:org.mitre.oval:ste:2281"/>
      </file_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2744"
                     version="1"
                     comment="64-Bit (x64 architecture) version of Windows is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:1576"/>
         <state state_ref="oval:org.mitre.oval:ste:2565"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2838"
                     version="1"
                     comment="Windows XP is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2657"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2761"
                     version="1"
                     comment="Windows Server 2003 is installed"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:419"/>
         <state state_ref="oval:org.mitre.oval:ste:2582"/>
      </registry_test>
      <registry_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                     id="oval:org.mitre.oval:tst:2437"
                     version="4"
                     comment="Win2K/XP/2003 is patched"
                     check_existence="at_least_one_exists"
                     check="at least one">
         <object object_ref="oval:org.mitre.oval:obj:717"/>
      </registry_test>
   </tests>
   <objects>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:1576"
                       version="1"
                       comment="This registry key identifies the architecture on the system">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SYSTEM\CurrentControlSet\Control\Session Manager\Environment</key>
         <name>PROCESSOR_ARCHITECTURE</name>
      </registry_object>
      <file_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                   id="oval:org.mitre.oval:obj:622"
                   version="1">
         <path var_ref="oval:org.mitre.oval:var:200" var_check="all"/>
         <filename>gdi32.dll</filename>
      </file_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:419"
                       version="1"
                       comment="This registry key holds the version of the installed operating system.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CurrentVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:717"
                       version="3"
                       comment="This registry key holds the service pack installed on the host if one is present.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>CSDVersion</name>
      </registry_object>
      <registry_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                       id="oval:org.mitre.oval:obj:219"
                       version="1"
                       comment="This registry key identifies the system root.">
         <hive>HKEY_LOCAL_MACHINE</hive>
         <key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</key>
         <name>SystemRoot</name>
      </registry_object>
   </objects>
   <states>
      <file_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  id="oval:org.mitre.oval:ste:2281"
                  version="1">
         <version datatype="version" operation="less than">5.2.3790.419</version>
      </file_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2565"
                      version="1">
         <value>x64</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2657"
                      version="1"
                      comment="Registry key has a value of 5.1">
         <value>5.1</value>
      </registry_state>
      <registry_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                      id="oval:org.mitre.oval:ste:2582"
                      version="1"
                      comment="The registry key has a value of 5.2">
         <value>5.2</value>
      </registry_state>
   </states>
   <variables>
      <local_variable id="oval:org.mitre.oval:var:200" version="1"
                      comment="Windows System32 directory"
                      datatype="string">
         <concat>
            <object_component item_field="value" object_ref="oval:org.mitre.oval:obj:219"/>
            <literal_component>\System32</literal_component>
         </concat>
      </local_variable>
   </variables>
</oval_definitions>